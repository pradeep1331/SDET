SELECT DISTINCT  -- Remove duplicate records
    LOC_PAL.WHSE_ID,
    LOC_PAL.BLDG_ID,
    LOC_PAL.LOC_ID,
    PALLET_DTL.SKU,
    PALLET_DTL.LOT_NO1,
    PALLET_DTL.EXPIRY_DATE,
    PALLET_HOLD_DTL.HOLD_CD1,
    PALLET_DTL.ONHAND_QTY
FROM LOC_PAL
JOIN PALLET_HDR ON LOC_PAL.WHSE_ID = PALLET_HDR.WHSE_ID AND LOC_PAL.BLDG_ID = PALLET_HDR.BLDG_ID AND LOC_PAL.PALLET_ID = PALLET_HDR.PALLET_ID
JOIN PALLET_DTL ON LOC_PAL.WHSE_ID = PALLET_DTL.WHSE_ID AND LOC_PAL.BLDG_ID = PALLET_DTL.BLDG_ID AND LOC_PAL.PALLET_ID = PALLET_DTL.PALLET_ID
LEFT JOIN PALLET_HOLD_DTL ON LOC_PAL.WHSE_ID = PALLET_HOLD_DTL.WHSE_ID AND LOC_PAL.BLDG_ID = PALLET_HOLD_DTL.BLDG_ID AND LOC_PAL.PALLET_ID = PALLET_HOLD_DTL.PALLET_ID
WHERE 
    LOC_PAL.WHSE_ID = 'your_desired_whse_id'
    AND LOC_PAL.BLDG_ID = 'your_desired_bldg_id'
    AND PALLET_DTL.ONHAND_QTY > 0
    -- Only include locations with multiple distinct SKUs
    AND EXISTS (
        SELECT 1
        FROM PALLET_DTL AS PD2
        WHERE PD2.WHSE_ID = LOC_PAL.WHSE_ID
            AND PD2.BLDG_ID = LOC_PAL.BLDG_ID
            AND PD2.LOC_ID = LOC_PAL.LOC_ID
            AND PD2.SKU <> PALLET_DTL.SKU
    )
